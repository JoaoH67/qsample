<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Efficiently sampling from quantum circuits and protocols">

<title>qsample</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="qsample">
<meta property="og:description" content="Efficiently sampling from quantum circuits and protocols">
<meta property="og:site-name" content="qsample">
<meta name="twitter:title" content="qsample">
<meta name="twitter:description" content="Efficiently sampling from quantum circuits and protocols">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">qsample</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">qsample</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">qsample</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./math.html" class="sidebar-item-text sidebar-link">Math</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./circuit.html" class="sidebar-item-text sidebar-link">Circuit</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./protocol.html" class="sidebar-item-text sidebar-link">Protocol</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sim.mixin.html" class="sidebar-item-text sidebar-link">Simulator Mixin</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sim.stabilizer.html" class="sidebar-item-text sidebar-link">CHP Simulator</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sim.statevector.html" class="sidebar-item-text sidebar-link">Statevector Simulator</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callbacks.html" class="sidebar-item-text sidebar-link">Sampler Callbacks</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampler.tree.html" class="sidebar-item-text sidebar-link">Count Tree</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampler.base.html" class="sidebar-item-text sidebar-link">Sampler base class</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampler.direct.html" class="sidebar-item-text sidebar-link">Direct Monte Carlo sampler</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampler.subset.html" class="sidebar-item-text sidebar-link">Subset Monte Carlo sampler</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./noise.html" class="sidebar-item-text sidebar-link">Noise / Error models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples.html" class="sidebar-item-text sidebar-link">Examples</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#install" id="toc-install" class="nav-link active" data-scroll-target="#install">Install</a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">Prerequisites</a></li>
  <li><a href="#when-to-use" id="toc-when-to-use" class="nav-link" data-scroll-target="#when-to-use">When to use</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting started</a>
  <ul class="collapse">
  <li><a href="#circuits" id="toc-circuits" class="nav-link" data-scroll-target="#circuits">Circuits</a></li>
  <li><a href="#protocols" id="toc-protocols" class="nav-link" data-scroll-target="#protocols">Protocols</a></li>
  </ul></li>
  <li><a href="#real-examples" id="toc-real-examples" class="nav-link" data-scroll-target="#real-examples">Real examples</a></li>
  <li><a href="#contribute" id="toc-contribute" class="nav-link" data-scroll-target="#contribute">Contribute</a></li>
  <li><a href="#planned-future-features" id="toc-planned-future-features" class="nav-link" data-scroll-target="#planned-future-features">planned future features</a></li>
  <li><a href="#submit-your-feature-request-via-github-issue" id="toc-submit-your-feature-request-via-github-issue" class="nav-link" data-scroll-target="#submit-your-feature-request-via-github-issue">submit your feature request via github issue</a>
  <ul class="collapse">
  <li><a href="#team" id="toc-team" class="nav-link" data-scroll-target="#team">Team</a></li>
  <li><a href="#license" id="toc-license" class="nav-link" data-scroll-target="#license">License</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/dpwinter/qsample/tree/master/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">qsample</h1>
</div>

<div>
  <div class="description">
    Efficiently sampling from quantum circuits and protocols
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="install" class="level2">
<h2 class="anchored" data-anchor-id="install">Install</h2>
<p><code>pip install qsample</code>… not yet, soon to come</p>
</section>
<section id="prerequisites" class="level2">
<h2 class="anchored" data-anchor-id="prerequisites">Prerequisites</h2>
</section>
<section id="when-to-use" class="level2">
<h2 class="anchored" data-anchor-id="when-to-use">When to use</h2>
<p>qsam offers efficient and fast estimation of logical failure rates of quantum error correction protocols when the fidelity of physical operations in the quantum circuits is high, such as in expertimental implementations today.</p>
<p>This package is for you if you want to * model circuit-level incoherent Pauli noise (we don’t do coherent noise here, neither are our auxiliary qubits modelled as ideal) * with high fidelity physical operations aka low physical error rates * for a QEC protocol that consists of execution of one or more quantum circuits with in-sequence measurements and feed-forward of measurement information * over a specific range of varying physical error rates</p>
<p>It currently offers to * build quantum circuits from the standard quantum gates: H, X, Z, CNOT * run stabilizer simulations with a standard CHP backend * model multiparameter noise with distinct error rates for single- and two-qubit gates: p1, p2 * estimate logical failure rates until uncertainty is lower than a given target confidence interval * choose direct Monte Carlo or Subset Sampling as sampling method</p>
<p>Background information:</p>
<p>The predominant method to model incoherent Pauli noise in quantum circuits is direct Monte Carlo (MC) sampling. MC is very inefficient for low physical error rates since most of the time no actual fault event is realized in simulation. Subset sampling circumvents this issue. With this method, presented in , fault events are categorized into distinct subsets which contribute to a polynomial sum expansion of the logical failure rate. In subset sampling, only the subsets that contribute most to the logical failure rate are actually estimated via sampling – rendering it an importance sampling technique. Both the sampling variance and the uncertainty from ignored, i.e.&nbsp;non-sampled, subsets stay well-defined and can be held small throughout the sampling procedure.</p>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting started</h2>
<section id="circuits" class="level3">
<h3 class="anchored" data-anchor-id="circuits">Circuits</h3>
<p>To get started, we first need to define one or more circuits, which is easily done in qsam. Below we create a circuit that prepares the 4-qubit GHZ state <span class="math inline">\(|\text{GHZ}\rangle=\frac{1}{\sqrt{2}}(|0000\rangle+|1111\rangle)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> qsample.circuit <span class="im">import</span> Circuit</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>ghz <span class="op">=</span> Circuit([ {<span class="st">"init"</span>: {<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>}},</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"H"</span>: {<span class="dv">0</span>}},</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">0</span>,<span class="dv">1</span>)}},</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">1</span>,<span class="dv">2</span>)}},</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">2</span>,<span class="dv">3</span>)}},</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">3</span>,<span class="dv">4</span>)}},</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">0</span>,<span class="dv">4</span>)}},</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"measure"</span>: {<span class="dv">4</span>}}], ff_det<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The keyword <code>ff_det</code>is set to <code>True</code> to indicate that the circuit will yield a deterministic outcome when ran fault-free. It is important for the calculation of uncertainties. This need not be the case, e.g.&nbsp;for circuits that measure stabilizers on unencoded states and thus yield random measurement results. An example of a fault-tolerant measurement circuit for the Steane code stabilizer <span class="math inline">\(Z_0Z_1Z_3Z_6\)</span> is given below. The default value of <code>ff_det</code>is <code>False</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sz_123 <span class="op">=</span> Circuit([{<span class="st">"init"</span>: {<span class="dv">8</span>}},</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">0</span>,<span class="dv">8</span>)}},</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">1</span>,<span class="dv">8</span>)}},</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">3</span>,<span class="dv">8</span>)}},</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">6</span>,<span class="dv">8</span>)}},</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"measure"</span>: {<span class="dv">8</span>}}])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add ghz run, explain all arguments and comparison of mc and ss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># also output errors, esp. show that delta only becomes smaller</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="protocols" class="level3">
<h3 class="anchored" data-anchor-id="protocols">Protocols</h3>
<p>From the single ghz-circuit given above, we may construct a simple toy-protocol to demonstrate essential features of qsam. The protocol is that, whenever the circuit measurement is <span class="math inline">\(-1\)</span>, we shall repeat the preparation circuit since the fifth qubit indicates preparation of an erroneous state. When the measurement is <span class="math inline">\(+1\)</span> the state is prepared correctly. If there is still no <span class="math inline">\(+1\)</span> after two preparation attempts, we count the protocol run as a logical failure. These conditions are defined in the following functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> qsample.protocol <span class="im">import</span> Protocol</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> repeat(m):</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(m) <span class="op">&lt;</span> <span class="dv">2</span> <span class="kw">and</span> m[<span class="op">-</span><span class="dv">1</span>] <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> logErr(m):</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(m) <span class="op">&gt;=</span> <span class="dv">2</span> <span class="kw">and</span> m[<span class="op">-</span><span class="dv">1</span>] <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> m[<span class="op">-</span><span class="dv">2</span>] <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>functions <span class="op">=</span> {<span class="st">'logErr'</span>: logErr, <span class="st">'repeat'</span>: repeat}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The protocol is now defined as a graph, where nodes are circuits and edges between the nodes are labelled with transition conditions between the circuits. Terminating a protocol with success (instead of fail) will not be shown explicitly by the protocol graph. The <code>check</code> argument takes a function, which returns a boolean, to evaluate a transition based on the sequence of measurement results stored in the node as a list (<code>ghz</code> in this example).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> Protocol(fault_tolerant<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>g._check_fns.update(functions)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>g.add_nodes_from([<span class="st">'ghz'</span>], circuits<span class="op">=</span>[ghz])</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>g.add_edge(<span class="st">'START'</span>, <span class="st">'ghz'</span>, check<span class="op">=</span><span class="st">'True'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>g.add_edge(<span class="st">'ghz'</span>, <span class="st">'ghz'</span>, check<span class="op">=</span><span class="st">'repeat(ghz)'</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>g.add_edge(<span class="st">'ghz'</span>, <span class="st">'FAIL'</span>, check<span class="op">=</span><span class="st">'logErr(ghz)'</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>g.draw(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We may now specify our error parameters, i.e.&nbsp;the range over which we wish to scale the physical error rates. Let’s start with a single parameter <span class="math inline">\(p\)</span> for both single- and two-qubit-gates. Here, we are exploring logical failure rates for physical error rates <span class="math inline">\(p \in [0.00001, 0.1]\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>scale <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">5</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>err_probs <span class="op">=</span> {<span class="st">'q'</span>: scale}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We initialize a new direct Monte Carlo sampler and set up a depolarizing noise model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> qsample.sim.stabilizer <span class="im">import</span> StabilizerSimulator <span class="im">as</span> CHP</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> qsample.sampler.direct <span class="im">import</span> DirectSampler</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> qsample.noise <span class="im">import</span> E1</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> qsample.callbacks <span class="im">as</span> cb</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>d_sam <span class="op">=</span> DirectSampler(protocol<span class="op">=</span>g, simulator<span class="op">=</span>CHP, err_model<span class="op">=</span>E1, err_probs<span class="op">=</span>err_probs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Its <code>run</code> function takes the maximum number of samples and/or user specified callback functions. Here we use for example the <a href="https://dpwinter.github.io/qsample/callbacks.html#relstdtarget"><code>RelStdTarget</code></a> callback to specify a maximum error of 10% (which is actually the default value) or 50000 samples at max. The logical failure rate estimator and its uncertainty are then plotted in the range defined by <code>scale</code> by the <a href="https://dpwinter.github.io/qsample/callbacks.html#plotstats"><code>PlotStats</code></a> callback from the relevant information (counts and fail_counts) which are stored directly in the <a href="https://dpwinter.github.io/qsample/sampler.base.html#sampler"><code>Sampler</code></a> object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>callbacks <span class="op">=</span> [</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    cb.RelStdTarget(target<span class="op">=</span><span class="fl">0.1</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    cb.PlotStats()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>d_sam.run(n_samples<span class="op">=</span><span class="dv">5000</span>, callbacks<span class="op">=</span>callbacks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fdbc293eb5884a16a3083127d624819f","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5c695de731a947db8a8cef9b6cc67012","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"587c72528a5a47e18daf1e9450c3fbe7","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6b57cfc84c13405ea9220c568b3ada7e","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3911b9f6aae8484eb925667fce858f10","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-12-output-6.png" class="img-fluid"></p>
</div>
</div>
<p>The sampler instance allows to print the logical failure rate estimator and its sampling and cutoff error over the sampled range.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>p_L, std <span class="op">=</span> d_sam.stats()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_L)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.0, 0.0, 0.0002, 0.0008, 0.0426]
[0.00038387 0.00038387 0.00054841 0.00087211 0.00560673]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> interact</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ipywidgets <span class="im">as</span> widgets</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_tree(i):</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"p_phy="</span>, <span class="bu">list</span>(d_sam.trees.keys())[i])</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="bu">list</span>(d_sam.trees.values())[i]).draw()</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>interact(get_tree, i<span class="op">=</span>widgets.IntSlider(<span class="bu">min</span><span class="op">=</span><span class="dv">0</span>, <span class="bu">max</span><span class="op">=</span><span class="bu">len</span>(d_sam.trees)<span class="op">-</span><span class="dv">1</span>, step<span class="op">=</span><span class="dv">1</span>, value<span class="op">=</span><span class="dv">0</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c6149590120742e7ad047ab0204f7abd","version_major":2,"version_minor":0}
</script>
</div>
</div>
<p>We can observe in the statistics of the direct MC Sampler that it does not even record logical failures with moderately low <span class="math inline">\(p\)</span> with the given number of samples. The Subset Sampler fixes this problem.</p>
<p>Additionally to just sampling the logical failure rate we can specify a variety of callbacks to track desired quantities of the sampling process. A comprehensive list is given in <code>directory</code>. Below we plot, for example, the logical failure rate at <code>p = p_max = 0.01</code> and its uncertainty as a function of the number of samples run.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> qsample.sampler.subset <span class="im">import</span> SubsetSampler</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>s_sam <span class="op">=</span> SubsetSampler(protocol<span class="op">=</span>g, simulator<span class="op">=</span>CHP, pmax<span class="op">=</span>{<span class="st">'q'</span>: <span class="fl">0.1</span>}, err_model<span class="op">=</span>E1, err_probs<span class="op">=</span>err_probs)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>callbacks <span class="op">=</span> [</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    cb.StatsPerSample()</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>s_sam.run(n_samples<span class="op">=</span><span class="dv">1000</span>, callbacks<span class="op">=</span>callbacks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"77413b975e094ec8a5ec98b993afc629","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The Sampler instance contains a <code>Tree</code> structure that we can investigate manually with <code>sb_sam.tree</code>, or plot as image.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>s_sam.tree.draw()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>From plotting the MC and SS results together we can see that they produce the same results in some intermediate regime of <span class="math inline">\(p\)</span>. Subset Sampling achieves tight bounds on the logical failure rate for low <span class="math inline">\(p\)</span> where the uncertainty for MC is large. Vice versa, Subset Sampling becomes inefficient if the cutoff error from only sampling a few subsets becomes large for larger <span class="math inline">\(p\)</span>. Here though, MC is efficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>p_L_low, ss_std, delta, delta_ss <span class="op">=</span> s_sam.stats()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>p_L, std,  <span class="op">=</span> d_sam.stats()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.errorbar(scale, p_L, fmt<span class="op">=</span><span class="st">'--'</span>, c<span class="op">=</span><span class="st">"black"</span>, yerr<span class="op">=</span>std, label<span class="op">=</span><span class="st">"Direct MC"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.plot(scale, p_L_low, label<span class="op">=</span><span class="st">"SS low"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.fill_between(scale, p_L_low<span class="op">-</span>ss_std, p_L_low<span class="op">+</span>delta<span class="op">+</span>ss_std, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>plt.plot(scale, p_L_low<span class="op">+</span>delta, label<span class="op">=</span><span class="st">"SS up"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>plt.fill_between(scale, p_L_low<span class="op">-</span>ss_std, p_L_low<span class="op">+</span>delta<span class="op">+</span>ss_std, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>plt.plot(scale, scale, <span class="st">'k:'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'log'</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">'log'</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r'$p_L$'</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r'$\lambda$ - uniform'</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>plt.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>With the already sampled subsets we can also vary the plotted range in retrospect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>adjusted_scale <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>p_L_low, ss_std, delta, _ <span class="op">=</span> s_sam.stats({<span class="st">'q'</span>: adjusted_scale})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(Below we also show the MC output in the adjusted range but for the direct Sampler we cannot modify the range in that way)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plt.errorbar(scale[<span class="op">-</span><span class="dv">2</span>:], p_L[<span class="op">-</span><span class="dv">2</span>:], fmt<span class="op">=</span><span class="st">'--'</span>, c<span class="op">=</span><span class="st">"black"</span>, yerr<span class="op">=</span>std[<span class="op">-</span><span class="dv">2</span>:], label<span class="op">=</span><span class="st">"Direct MC"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plt.plot(adjusted_scale, p_L_low, label<span class="op">=</span><span class="st">"SS low"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plt.fill_between(adjusted_scale, p_L_low<span class="op">-</span>ss_std, p_L_low<span class="op">+</span>delta<span class="op">+</span>ss_std, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.plot(adjusted_scale, p_L_low<span class="op">+</span>delta, label<span class="op">=</span><span class="st">"SS up"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.fill_between(adjusted_scale, p_L_low<span class="op">-</span>ss_std, p_L_low<span class="op">+</span>delta<span class="op">+</span>ss_std, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'log'</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">'log'</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r'$p_L$'</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r'$\lambda$ - uniform'</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>plt.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We may add 100 more samples to the already existing 500 samples…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>s_sam.run(<span class="dv">100</span>, callbacks<span class="op">=</span>callbacks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"34b46f11243a4291b4743d0917abb011","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-20-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>… or pickle it for later use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s_sam.tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ghz (1100, 0.00e+00)
├── (0,) (1, 1.57e-01)
│   └── None (1/1)
├── (1,) (841, 1.11e-03)
│   ├── None (482/841)
│   └── ghz (359/841)
│       ├── (2,) (81, 1.13e-02)
│       │   ├── FAIL (43/81)
│       │   └── None (38/81)
│       ├── (1,) (266, 3.48e-03)
│       │   ├── None (153/266)
│       │   └── FAIL (113/266)
│       ├── (0,) (1, 1.57e-01)
│       │   └── None (1/1)
│       └── (3,) (11, 6.43e-02)
│           ├── FAIL (5/11)
│           └── None (6/11)
├── (3,) (26, 3.15e-02)
│   ├── None (11/26)
│   └── ghz (15/26)
│       ├── (2,) (3, 1.34e-01)
│       │   ├── None (1/3)
│       │   └── FAIL (2/3)
│       ├── (0,) (1, 1.57e-01)
│       │   └── None (1/1)
│       └── (1,) (11, 6.43e-02)
│           ├── FAIL (5/11)
│           └── None (6/11)
├── (2,) (228, 4.14e-03)
│   ├── None (114/228)
│   └── ghz (114/228)
│       ├── (0,) (1, 1.57e-01)
│       │   └── None (1/1)
│       ├── (1,) (86, 1.01e-02)
│       │   ├── FAIL (33/86)
│       │   └── None (53/86)
│       ├── (3,) (2, 1.64e-01)
│       │   ├── FAIL (1/2)
│       │   └── None (1/2)
│       └── (2,) (25, 3.21e-02)
│           ├── None (15/25)
│           └── FAIL (10/25)
└── (4,) (4, 1.07e-01)
    ├── None (3/4)
    └── ghz (1/4)
        └── (0,) (1, 1.57e-01)
            └── None (1/1)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>s_sam.save(<span class="st">'ghz_rep'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>s_sam2 <span class="op">=</span> SubsetSampler.load(<span class="st">'ghz_rep'</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s_sam2.tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ghz (1100, 0.00e+00)
├── (0,) (1, 1.57e-01)
│   └── None (1/1)
├── (1,) (841, 1.11e-03)
│   ├── None (482/841)
│   └── ghz (359/841)
│       ├── (2,) (81, 1.13e-02)
│       │   ├── FAIL (43/81)
│       │   └── None (38/81)
│       ├── (1,) (266, 3.48e-03)
│       │   ├── None (153/266)
│       │   └── FAIL (113/266)
│       ├── (0,) (1, 1.57e-01)
│       │   └── None (1/1)
│       └── (3,) (11, 6.43e-02)
│           ├── FAIL (5/11)
│           └── None (6/11)
├── (3,) (26, 3.15e-02)
│   ├── None (11/26)
│   └── ghz (15/26)
│       ├── (2,) (3, 1.34e-01)
│       │   ├── None (1/3)
│       │   └── FAIL (2/3)
│       ├── (0,) (1, 1.57e-01)
│       │   └── None (1/1)
│       └── (1,) (11, 6.43e-02)
│           ├── FAIL (5/11)
│           └── None (6/11)
├── (2,) (228, 4.14e-03)
│   ├── None (114/228)
│   └── ghz (114/228)
│       ├── (0,) (1, 1.57e-01)
│       │   └── None (1/1)
│       ├── (1,) (86, 1.01e-02)
│       │   ├── FAIL (33/86)
│       │   └── None (53/86)
│       ├── (3,) (2, 1.64e-01)
│       │   ├── FAIL (1/2)
│       │   └── None (1/2)
│       └── (2,) (25, 3.21e-02)
│           ├── None (15/25)
│           └── FAIL (10/25)
└── (4,) (4, 1.07e-01)
    ├── None (3/4)
    └── ghz (1/4)
        └── (0,) (1, 1.57e-01)
            └── None (1/1)</code></pre>
</div>
</div>
</section>
</section>
<section id="real-examples" class="level2">
<h2 class="anchored" data-anchor-id="real-examples">Real examples</h2>
<p>For more complicated protocols, we might want to receive more feedback from what the sampler is actually doing. Using the <code>verbose</code> keyword, we can print the actual circuit sequences realized through out the sampling procedure and watch which intermediate measurement results lead to different circuit branchings.</p>
<p>To illustrate this, we give the example of first preparing the logical zero state of the Steane code. A flag qubit verifies correct preparation in the first circuit. The second circuit is only run, if the flag is triggered. It restores the correct state in a fault-tolerant way from the state after the first circuit marked as faulty by the flag.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>eft <span class="op">=</span> Circuit([ {<span class="st">"init"</span>: {<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>}},</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"H"</span>: {<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>}},</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">0</span>,<span class="dv">4</span>)}},</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">1</span>,<span class="dv">2</span>)}},</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">3</span>,<span class="dv">5</span>)}},</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">0</span>,<span class="dv">6</span>)}},</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">3</span>,<span class="dv">4</span>)}},</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">1</span>,<span class="dv">5</span>)}},</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">0</span>,<span class="dv">2</span>)}},</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">5</span>,<span class="dv">6</span>)}},</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">4</span>,<span class="dv">7</span>)}},</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">2</span>,<span class="dv">7</span>)}},</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">5</span>,<span class="dv">7</span>)}},</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"measure"</span>: {<span class="dv">7</span>}} ], ff_det<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>sz_123 <span class="op">=</span> Circuit([{<span class="st">"init"</span>: {<span class="dv">8</span>}},</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">0</span>,<span class="dv">8</span>)}},</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">1</span>,<span class="dv">8</span>)}},</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">3</span>,<span class="dv">8</span>)}},</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"CNOT"</span>: {(<span class="dv">6</span>,<span class="dv">8</span>)}},</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"measure"</span>: {<span class="dv">8</span>}}])</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>meas <span class="op">=</span> Circuit([ {<span class="st">"measure"</span>: {<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>}} ])</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>k1 <span class="op">=</span> <span class="bn">0b0001111</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>k2 <span class="op">=</span> <span class="bn">0b1010101</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>k3 <span class="op">=</span> <span class="bn">0b0110011</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>k12 <span class="op">=</span> k1 <span class="op">^</span> k2</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>k23 <span class="op">=</span> k2 <span class="op">^</span> k3</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>k13 <span class="op">=</span> k1 <span class="op">^</span> k3</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>k123 <span class="op">=</span> k12 <span class="op">^</span> k3</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>stabilizerGenerators <span class="op">=</span> [k1, k2, k3]</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>stabilizerSet <span class="op">=</span> [<span class="dv">0</span>, k1, k2, k3, k12, k23, k13, k123]</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamming2(x, y):</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    count, z <span class="op">=</span> <span class="dv">0</span>, x <span class="op">^</span> y</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> z:</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>        z <span class="op">&amp;=</span> z <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> logErr(out):</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">min</span>([hamming2(out, i) <span class="cf">for</span> i <span class="kw">in</span> stabilizerSet]) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> flagged_z_look_up_table_1(z):</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> z:</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Circuit([{<span class="st">'X'</span>: {<span class="dv">6</span>}}], noisy<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Circuit(noisy<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>functions <span class="op">=</span> {<span class="st">"logErr"</span>: logErr, <span class="st">"lut"</span>: flagged_z_look_up_table_1}</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>init <span class="op">=</span> Protocol(fault_tolerant<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>init._check_fns.update(functions)</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>init.add_nodes_from([<span class="st">'ENC'</span>, <span class="st">'SZ'</span>, <span class="st">'meas'</span>], circuits<span class="op">=</span>[eft, sz_123, meas])</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>init.add_node(<span class="st">'X_COR'</span>, circuit<span class="op">=</span>Circuit(noisy<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>init.add_edge(<span class="st">'START'</span>, <span class="st">'ENC'</span>, check<span class="op">=</span><span class="st">'True'</span>)</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>init.add_edge(<span class="st">'ENC'</span>, <span class="st">'meas'</span>, check<span class="op">=</span><span class="st">'ENC[-1]==0'</span>)</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>init.add_edge(<span class="st">'ENC'</span>, <span class="st">'SZ'</span>, check<span class="op">=</span><span class="st">'ENC[-1]==1'</span>)</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>init.add_edge(<span class="st">'SZ'</span>, <span class="st">'X_COR'</span>, check<span class="op">=</span><span class="st">'lut(SZ[-1])'</span>)</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>init.add_edge(<span class="st">'X_COR'</span>, <span class="st">'meas'</span>, check<span class="op">=</span><span class="st">'True'</span>)</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>init.add_edge(<span class="st">'meas'</span>, <span class="st">'FAIL'</span>, check<span class="op">=</span><span class="st">'logErr(meas[-1])'</span>)</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>init.draw(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">8</span>), legend<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The protocol contains a recovery operation which is applied conditioned on the stabilizer measurement result being <span class="math inline">\(-1\)</span>. The <code>check</code> function, which we previously introduced to only take boolean values, in this case actually accepts a circuit which corresponds to the recovery operation. To avoid also placing fault operators on this circuit, we use the keyword <code>noisy</code> and set it to <code>False</code> (this can be used for any circuit). The recovery operation is the return value of the look up table function we define above.</p>
<p>We may choose more realistic error rates for single and two qubit gates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>err_probs <span class="op">=</span> {<span class="st">'q1'</span>: <span class="fl">0.01</span> <span class="op">*</span> scale, <span class="st">'q2'</span>: <span class="fl">0.1</span> <span class="op">*</span> scale}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s first run 10 samples to see what the protocol does. For this means we can use the <a href="https://dpwinter.github.io/qsample/callbacks.html#verbosecircuitexec"><code>VerboseCircuitExec</code></a> callback:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> qsample.noise <span class="im">import</span> E2</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>sb_sam <span class="op">=</span> SubsetSampler(init, CHP, pmax<span class="op">=</span>{<span class="st">'q1'</span>: <span class="fl">0.01</span>, <span class="st">'q2'</span>: <span class="fl">0.1</span>}, err_probs<span class="op">=</span>err_probs, err_model<span class="op">=</span>E2)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>callbacks <span class="op">=</span> [</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    cb.VerboseCircuitExec()</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>sb_sam.run(<span class="dv">10</span>, callbacks<span class="op">=</span>callbacks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"981eea3577cc48129407b1d3c5199c95","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ENC -&gt; Faults: [] -&gt; Msmt: 0
meas -&gt; Faults: [] -&gt; Msmt: 1100110
None
ENC -&gt; Faults: [(9, {'Y': {5, 6}}), (10, {'Z': {4}, 'X': {7}})] -&gt; Msmt: 0
meas -&gt; Faults: [] -&gt; Msmt: 0001100
FAIL
ENC -&gt; Faults: [(2, {'X': {0}})] -&gt; Msmt: 1
SZ -&gt; Faults: [(1, {'Z': {0}})] -&gt; Msmt: 0
None
ENC -&gt; Faults: [(12, {'Y': {5, 7}})] -&gt; Msmt: 1
SZ -&gt; Faults: [(2, {'Z': {1}, 'X': {8}})] -&gt; Msmt: 1
X_COR: [(0, {'X': {6}})]
meas -&gt; Faults: [] -&gt; Msmt: 0110000
FAIL
ENC -&gt; Faults: [(2, {'Z': {0}})] -&gt; Msmt: 0
meas -&gt; Faults: [] -&gt; Msmt: 0110011
None
ENC -&gt; Faults: [(5, {'Z': {0}, 'X': {6}}), (6, {'Y': {3, 4}}), (7, {'X': {5}})] -&gt; Msmt: 0
meas -&gt; Faults: [] -&gt; Msmt: 0001110
None
ENC -&gt; Faults: [(4, {'Z': {3}, 'Y': {5}}), (6, {'X': {3, 4}}), (9, {'Z': {5}})] -&gt; Msmt: 0
meas -&gt; Faults: [] -&gt; Msmt: 1101001
None
ENC -&gt; Faults: [(2, {'Y': {0}, 'Z': {4}}), (8, {'X': {0, 2}})] -&gt; Msmt: 0
meas -&gt; Faults: [] -&gt; Msmt: 1010100
None
ENC -&gt; Faults: [(2, {'Y': {0}, 'Z': {4}})] -&gt; Msmt: 1
SZ -&gt; Faults: [] -&gt; Msmt: 0
None
ENC -&gt; Faults: [(10, {'Y': {4}})] -&gt; Msmt: 0
meas -&gt; Faults: [] -&gt; Msmt: 0110111
None</code></pre>
</div>
</div>
<p>When the flag is triggered, measurement of <span class="math inline">\(Z_0Z_1Z_3Z_6\)</span> follows.</p>
<p>We can now go on and sample in a regime virtually inaccessible to direct MC until our target uncertainty of – let say 5% – is reached.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>err_probs <span class="op">=</span> {<span class="st">'q1'</span>: <span class="fl">0.0001</span> <span class="op">*</span> scale, <span class="st">'q2'</span>: <span class="fl">0.001</span> <span class="op">*</span> scale}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sb_sam <span class="op">=</span> SubsetSampler(init, CHP, pmax<span class="op">=</span>{<span class="st">'q1'</span>: <span class="fl">0.01</span>, <span class="st">'q2'</span>: <span class="fl">0.1</span>}, err_probs<span class="op">=</span>err_probs, err_model<span class="op">=</span>E2)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>callbacks <span class="op">=</span> [</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    cb.RelStdTarget(target<span class="op">=</span><span class="fl">0.01</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    cb.StatsPerSample(),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    cb.PlotStats()</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>sb_sam.run(<span class="dv">1_000</span>, callbacks<span class="op">=</span>callbacks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2bc6f5868742486790ab435c8ea1bfcd","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-28-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-28-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sb_sam.tree.draw()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>More elaborate examples are given in <code>directory</code>.</p>
</section>
<section id="contribute" class="level2">
<h2 class="anchored" data-anchor-id="contribute">Contribute</h2>
</section>
<section id="planned-future-features" class="level1">
<h1>planned future features</h1>
<ul>
<li>statevector backend</li>
<li>MS gates</li>
<li>crosstalk and idling noise</li>
</ul>
</section>
<section id="submit-your-feature-request-via-github-issue" class="level1">
<h1>submit your feature request via github issue</h1>
<section id="team" class="level2">
<h2 class="anchored" data-anchor-id="team">Team</h2>
<p>qsam was developed by Don Winter based on and in collaboration with Sascha Heußen under supervision of Prof.&nbsp;Dr.&nbsp;Markus Müller.</p>
</section>
<section id="license" class="level2">
<h2 class="anchored" data-anchor-id="license">License</h2>


</section>
</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>